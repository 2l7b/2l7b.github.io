<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Solana Whale Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --primary: #00f2ff;
      --bg-dark: #0b0e1c;
      --card-dark: #11152b;
    }
    @keyframes popupFade {
      0% { opacity: 0; transform: translateY(-10px); }
      10%, 90% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-10px); }
    }
    .popup {
      animation: popupFade 5s ease-out forwards;
    }
  </style>
</head>
<body class="bg-[var(--bg-dark)] text-white min-h-screen p-6 font-sans">
  <header class="text-center mb-12">
    <h1 class="text-5xl font-extrabold tracking-tight text-[var(--primary)]">Solana Whale Tracker</h1>
    <p class="text-gray-400 mt-3 text-lg">Live whale trades from Solscan</p>
  </header>

  <!-- Popup area -->
  <div id="popup-container" class="fixed top-4 right-4 space-y-2 z-50"></div>

  <!-- Whale Leaderboard -->
  <section class="max-w-4xl mx-auto mb-12">
    <h2 class="text-3xl font-bold mb-4 text-[var(--primary)]">Whale Leaderboard</h2>
    <ul id="leaderboard" class="bg-[var(--card-dark)] border border-gray-700 rounded-2xl shadow-xl p-4 divide-y divide-gray-800">
      <!-- Dynamic entries -->
    </ul>
  </section>

  <script>
    const popupContainer = document.getElementById('popup-container');
    const leaderboard = document.getElementById('leaderboard');

    async function fetchWhales() {
      try {
        const res = await fetch('https://api.allorigins.win/raw?url=https://solscan.io/leaderboard/whale-tracking');
        const html = await res.text();
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
        const rows = [...doc.querySelectorAll('table tbody tr')];

        leaderboard.innerHTML = '';

        rows.forEach((row, i) => {
          const cells = row.querySelectorAll('td');
          if (cells.length >= 3) {
            const rank = cells[0].textContent.trim();
            const address = cells[1].textContent.trim();
            const value = cells[2].textContent.trim();

            const li = document.createElement('li');
            li.className = 'flex justify-between py-2';
            li.innerHTML = `<span class="text-sm">${rank}. ${address}</span><span class="text-green-400 font-bold">${value}</span>`;

            leaderboard.appendChild(li);

            if (i < 3) {
              const popup = document.createElement('div');
              popup.className = 'popup bg-[var(--primary)] text-black font-bold px-6 py-3 rounded-xl shadow-lg';
              popup.textContent = `🐋 New Whale: ${address}`;
              popupContainer.appendChild(popup);
              setTimeout(() => popup.remove(), 5000);
            }
          }
        });
      } catch (err) {
        console.error('Error fetching whales:', err);
      }
    }

    fetchWhales();
    setInterval(fetchWhales, 30000);
  </script>
</body>
</html>
